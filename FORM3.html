<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Entrada</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px; /* Adicionado padding para melhor visualização em telas pequenas */
            box-sizing: border-box;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
        }
        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold; /* Adicionado para destacar labels */
        }
        input[type="text"],
        input[type="tel"],
        input[type="number"],
        select,
        textarea {
            width: calc(100% - 22px); /* Ajustado para compensar padding/border */
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }
        input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2); /* Aumenta um pouco o tamanho do checkbox */
            vertical-align: middle;
        }
        .checkbox-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .checkbox-group label {
            font-weight: normal; /* Labels de checkbox não tão bold */
            margin-bottom: 0;
            display: inline-block;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #0056b3;
        }
        .message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
        }
        .message.success {
            background-color: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }
        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Registro de Entrada</h2>
        <form id="registroForm">
            <label for="Evento">Evento:</label>
            <input type="text" id="Evento" name="Evento" required>

            <label for="Nome">Nome Completo:</label>
            <input type="text" id="Nome" name="Nome" required>

            <label for="Celular">Celular (com DDD):</label>
            <input type="tel" id="Celular" name="Celular" placeholder="(XX) XXXXX-XXXX" required>

            <label for="Dia Aniversario">Dia do Aniversário:</label>
            <input type="number" id="Dia Aniversario" name="Dia Aniversario" min="1" max="31">

            <label for="Mes Aniversario">Mês do Aniversário:</label>
            <input type="number" id="Mes Aniversario" name="Mes Aniversario" min="1" max="12">

            <label for="Comanda">Comanda:</label>
            <input type="text" id="Comanda" name="Comanda">

            <div class="checkbox-group">
                <input type="checkbox" id="Eh Crianca" name="Eh Crianca" value="Sim">
                <label for="Eh Crianca">É Criança?</label>
            </div>

            <label for="Observacao">Observação:</label>
            <textarea id="Observacao" name="Observacao" rows="3"></textarea>

            <button type="submit">Registrar Entrada</button>
            <div id="formMessage" class="message"></div>
        </form>
    </div>

    <script>
        const form = document.getElementById('registroForm');
        const formMessage = document.getElementById('formMessage');

        form.addEventListener('submit', async function(e) {
            e.preventDefault(); // Impede o envio padrão do formulário

            formMessage.textContent = 'Enviando... Aguarde a resposta do servidor.';
            formMessage.className = 'message'; // Limpa classes de sucesso/erro

            const formData = new FormData(form);
            const data = {};
            for (const [key, value] of formData.entries()) {
                data[key] = value;
            }

            // =========================================================================
            // IMPORTANTE: VOCÊ PRECISA COLOCAR A URL DO SEU GOOGLE APPS SCRIPT AQUI!
            // Copie a URL da sua implantação "Aplicativo da Web" do Apps Script.
            // =========================================================================
            const gasUrl = 'https://script.google.com/macros/s/AKfycbySosfC1rxxIlVZ9oH3S6uem8Yw-k1wd6bFQnZoHicSHMOIpVr0aG5SyEZTokPlcyHQ/exec'; 

            try {
                const response = await fetch(gasUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        // Esta linha é crucial para tentar resolver o erro de CORS
                        'Origin': 'https://gspassuncao-star.github.io' 
                    },
                    body: new URLSearchParams(data).toString()
                });

                // Tenta ler a resposta como JSON
                const result = await response.json(); 
                
                // Loga a resposta completa no console do navegador para depuração
                console.log('--- Resposta COMPLETA do Apps Script ---', result); 

                if (result.status === 'success') {
                    formMessage.textContent = '✅ Sucesso! ' + result.message;
                    formMessage.className = 'message success';
                    form.reset(); // Limpa o formulário após o envio
                } else {
                    formMessage.textContent = '❌ ERRO: ' + result.message;
                    formMessage.className = 'message error';
                    // Imprime detalhes adicionais no console do navegador
                    console.error('Dados que o Apps Script RECEBEU:', result.received);
                    console.error('Linha que o Apps Script TENTOU ADICIONAR:', result.rowToAppend);
                    if (result.stack) {
                        console.error('Rastreamento de pilha do erro (Stack Trace):', result.stack);
                    }
                }
            } catch (error) {
                console.error('Erro de rede ou ao processar a resposta do formulário:', error);
                formMessage.textContent = '❌ Ocorreu um erro de comunicação ou processamento no navegador. Verifique o console (F12) para detalhes.';
                formMessage.className = 'message error';
            }
        });
    </script>
</body>
</html>

